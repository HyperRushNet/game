<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HyperRush Games | Embed</title>
  <style>
    /* Basis Layout */
    html, body { 
      height: 100%; 
      margin: 0; 
      padding: 0; 
      overflow: hidden; 
      font-family: 'Segoe UI', Arial, sans-serif; 
      background: #000; 
      color: #fff; 
    }
   
    /* Iframe Styling */
    iframe { 
      width: 100%; 
      height: 100%; 
      border: 0; 
      position: absolute; 
      inset: 0; 
      z-index: 1; 
      opacity: 0; 
      transition: opacity .8s ease-in; 
    }
    iframe.loaded { 
      opacity: 1; 
    }
    
    /* Loader & Overlay */
    #loader { 
      position: fixed; 
      inset: 0; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      background: #000; 
      z-index: 9999; 
      flex-direction: column; 
      gap: 15px; 
    }
    .spinner { 
      width: 40px; 
      height: 40px; 
      border: 3px solid rgba(255,255,255,0.1); 
      border-top-color: #00d4ff; 
      border-radius: 50%; 
      animation: spin .8s linear infinite; 
    }
    @keyframes spin { 
      to { transform: rotate(360deg); } 
    }
    
    #game-overlay { 
      position: absolute; 
      inset: 0; 
      z-index: 2; 
      background: #000; 
      pointer-events: none; 
    }
    #game-overlay canvas { 
      width: 100%; 
      height: 100%; 
      display: block; 
    }

    /* Credits - Rechts onderaan, fade na 10s (laatste 1s fade) */
    .hrn-credits {
      position: fixed;
      bottom: 14px;
      right: 16px;
      z-index: 10000;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 1.1px;
      color: #ffffff;
      text-transform: uppercase;
      background: rgba(0, 0, 0, 0.75);
      padding: 6px 14px;
      border-radius: 6px;
      pointer-events: none;
      user-select: none;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
      opacity: 1;
      animation: fadeOutCredits 10s forwards;
    }

    @keyframes fadeOutCredits {
      0%    { opacity: 1; }
      90%   { opacity: 1; }   /* 9 seconden volledig zichtbaar */
      100%  { opacity: 0; }   /* fade in laatste 1 seconde */
    }
  </style>
</head>
<body>
  <div id="loader">
    <div class="spinner"></div>
    <span style="font-size: 14px; opacity: 0.8;">LOADING HYPERRUSH...</span>
  </div>
  <div id="game-overlay">
    <canvas id="particles"></canvas>
  </div>

  <div class="hrn-credits">Powered by HyperRush</div>

  <script>
    // === Redirect-block met URL param override ===
    (function() {
      const urlParams = new URLSearchParams(window.location.search);
      const allowDirect = urlParams.get('allowdirect');  // ?allowdirect=1 of true

      const isAllowedDirect = allowDirect === '1' || 
                              allowDirect === 'true' || 
                              allowDirect === 'yes';

      // Check of we in een iframe zitten
      const inIframe = (function() {
        try {
          return window.self !== window.top;
        } catch (e) {
          return true;  // Bij cross-origin errors → behandel als iframe (veiligste keuze)
        }
      })();

      // Als NIET in iframe EN direct toegang NIET toegestaan → redirect
      if (!inIframe && !isAllowedDirect) {
        // Pas dit aan naar waar je wilt redirecten bij directe toegang
        // Voorbeeld: je eigen embed-pagina, of homepage
        window.location.replace("https://jouw-domein.be/embed.html");  
        // Of simpelweg een foutpagina: window.location.replace("/not-allowed");
        return;  // Stop verdere uitvoering
      }
    })();

    // === Rest van je originele script ===
    const urlParams = new URLSearchParams(window.location.search);
    const gameUrl = urlParams.get('url') || "https://hyperrushnet.github.io/games-1/bacon-may-die/";

    const canvas = document.getElementById("particles");
    const ctx = canvas.getContext("2d");
    let particles = [];

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    function createParticle() {
      particles.push({
        x: Math.random() * canvas.width,
        y: -10,
        vx: (Math.random() - 0.5) * 1.5,
        vy: Math.random() * 2 + 1,
        radius: Math.random() * 2 + 0.5,
        alpha: Math.random() * 0.5 + 0.2
      });
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles.forEach((p, i) => {
        p.x += p.vx;
        p.y += p.vy;
        if (p.y > canvas.height) particles.splice(i, 1);
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(0, 212, 255, ${p.alpha})`;
        ctx.fill();
      });
      requestAnimationFrame(animate);
    }

    setInterval(createParticle, 100);
    animate();

    function loadEmbed() {
      if (!gameUrl) {
        document.getElementById("loader").innerHTML = "No Game URL provided.";
        return;
      }
      const ifr = document.createElement("iframe");
      ifr.src = gameUrl;
      ifr.allow = "autoplay; fullscreen; keyboard; gamepad; microphone";
      ifr.setAttribute("sandbox", "allow-scripts allow-same-origin allow-pointer-lock allow-forms");
     
      ifr.onload = () => {
        ifr.classList.add("loaded");
        document.getElementById("loader").style.display = "none";
        document.getElementById("game-overlay").style.display = "none";
        ifr.focus();
      };
      document.body.appendChild(ifr);
    }

    window.addEventListener("DOMContentLoaded", loadEmbed);
  </script>
</body>
</html>
